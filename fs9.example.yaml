# FS9 Configuration Example
# Copy to ~/.config/fs9/fs9.yaml or ./fs9.yaml

server:
  host: "0.0.0.0"
  port: 9999

  auth:
    enabled: false
    jwt_secret: "${FS9_JWT_SECRET}"
    issuer: "fs9"
    audience: "fs9-clients"

  # Meta service connection (required for production)
  # meta_url: "http://localhost:9998"
  # meta_key: "${FS9_META_KEY}"

  # Request limits
  request_timeout_secs: 30
  max_concurrent_requests: 1000
  shutdown_timeout_secs: 30
  max_body_size_bytes: 2097152       # 2MB default for API requests
  max_write_size_bytes: 268435456    # 256MB for file write endpoint

  # Per-tenant rate limiting
  rate_limit:
    enabled: true
    namespace_qps: 1000
    user_qps: 100

  # Prometheus metrics
  metrics:
    enabled: true
    path: "/metrics"

  # Meta client circuit breaker
  meta_resilience:
    failure_threshold: 5
    recovery_timeout_secs: 30
    max_retry_attempts: 3
    base_delay_ms: 100

  plugins:
    directories:
      - "./plugins"
      - "/usr/lib/fs9/plugins"
    preload: []

mounts:
  - path: "/"
    provider: memfs

  # Uncomment to add S3-backed storage:
  # - path: "/data"
  #   provider: pagefs
  #   config:
  #     backend:
  #       type: s3
  #       bucket: "my-fs9-bucket"
  #       prefix: "data"
  #     uid: 1000
  #     gid: 1000

  # Uncomment for local filesystem passthrough:
  # - path: "/local"
  #   provider: localfs
  #   config:
  #     root: "/srv/fs9-data"

  # Uncomment for remote FS9 proxy:
  # - path: "/remote"
  #   provider: proxyfs
  #   config:
  #     upstream: "https://other-fs9.example.com:9999"
  #     token: "${FS9_REMOTE_TOKEN}"

fuse:
  server: "http://localhost:9999"
  token: "${FS9_TOKEN}"

  options:
    allow_other: false
    allow_root: false
    auto_unmount: true
    read_only: false

  cache:
    attr_ttl: "1s"
    entry_ttl: "1s"

shell:
  server: "http://localhost:9999"
  token: "${FS9_TOKEN}"
  prompt: "sh9:{cwd}> "

  history:
    enabled: true
    file: "~/.fs9_history"
    max_entries: 10000

logging:
  level: info
  format: pretty
  filter: ""
